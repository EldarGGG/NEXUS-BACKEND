{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>{% block title %}{% endblock %}</title>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- static styles -->
    <script src="https://cdn.tailwindcss.com" defer></script>
    <link rel="stylesheet" href="{% static '/style/style.css' %}">
    <link rel="stylesheet" href="{% static '/style/modal.css' %}">
    <link rel="stylesheet" href="{% static '/style/buttons.css' %}">
    <link rel="stylesheet" href="{% static '/style/snackbar.css' %}">
    <script src="https://unpkg.com/htmx.org@1.9.10"
            integrity="sha384-D1Kt99CQMDuVetoL1lrYwg5t+9QdHe7NLX/SoJYkXDFfX37iInKRy5xLSi8nO7UC"
            crossorigin="anonymous"></script>
</head>
<body>

<div class="sidebar bg-gray-800 rounded-lg dark:border dark:border-gray-700">
    <div class="sidebar-header">
        <svg width="81" height="12" viewBox="0 0 81 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M75.9616 4.71213C78.8719 4.71213 80.3271 5.74711 80.3271 7.81908C80.3271 10.2978 78.6632 11.5374 75.3353 11.5374L64.5351 11.5219L66.8132 8.61694H75.6139C76.4369 8.61694 76.849 8.33965 76.849 7.78508C76.849 7.24159 76.4369 6.97085 75.6139 6.97085H69.283C67.8336 6.97085 66.7322 6.67039 65.9789 6.06986C65.2713 5.51541 64.9178 4.72913 64.9178 3.71014C64.9178 1.35534 66.5814 0.178446 69.9091 0.178446H80.014L77.7012 3.13278H69.6313C68.8077 3.13278 68.3963 3.39294 68.3963 3.91351C68.3963 4.44567 68.8077 4.71213 69.6313 4.71213H75.9616ZM63.5208 6.57985C63.5208 10.0092 61.1035 11.7245 56.2682 11.7245C53.4857 11.7245 51.445 11.2936 50.146 10.4338C48.8826 9.60734 48.251 8.32253 48.251 6.57985V0.177942H51.8336V6.57985C51.8336 7.44005 52.112 8.02308 52.6685 8.32857C53.2484 8.64515 54.4481 8.80419 56.2682 8.80419C57.6365 8.80419 58.5874 8.63394 59.1209 8.29457C59.6425 7.96679 59.9034 7.39484 59.9034 6.57985V0.177942H63.5208V6.57985ZM47.2193 0.177942L43.5498 3.45552C42.2508 4.59892 41.387 5.3342 40.9586 5.66286C41.2134 5.83236 42.1524 6.65238 43.7757 8.12483L47.4974 11.5374H42.4191L38.4537 7.78508L34.3667 11.5374H29.897L33.6882 8.12483C35.045 6.90197 35.9493 6.12715 36.4014 5.79811L36.2448 5.67986C36.1522 5.61199 36.0886 5.56099 36.0539 5.52724C35.9377 5.43632 35.7752 5.30033 35.5667 5.1195C35.1026 4.72334 34.4764 4.16297 33.6882 3.4384L30.1229 0.177942H35.1145L38.8189 3.71014L42.5584 0.177942H47.2193ZM29.4621 8.61682L27.149 11.5374H15.9486V0.177942H29.4271L27.0969 3.13278H19.5656V4.4905H28.7836L26.7139 7.07121H19.5656V8.61682H29.4621ZM3.26915 4.8645V11.5374H0V2.11392C0 1.40093 0.196834 0.857686 0.591273 0.484318C0.962108 0.15578 1.41988 -0.00830078 1.96497 -0.00830078C2.49885 -0.00830078 2.97932 0.194943 3.40884 0.602688L10.5391 6.85135V0.177942H13.8265V9.58493C13.8265 10.2979 13.6296 10.8412 13.235 11.2149C12.8754 11.5547 12.4118 11.7245 11.8438 11.7245C11.3217 11.7245 10.8408 11.5204 10.4003 11.1132L3.26915 4.8645Z"
                  fill="#EEF0F4"></path>
        </svg>
    </div>

    <ul class="space-y-2 font-medium w-full px-4">
        <li class="text-left">
            <a href="{% url 'home_store' request.store.id %}"
               class="transition-all duration-150 flex items-center p-2 px-1 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group {% if request.active_page == 'home' %}dark:bg-gray-700{% endif %}">
                <span class="ms-3">Рабочий стол</span>
            </a>
        </li>
        <li class="text-left">
            <a href="{% url 'create_store' request.store.id %}"
               class="transition-all duration-150 flex items-center p-2 px-1 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group {% if request.active_page == 'create' %}dark:bg-gray-700{% endif %}">
                <span class="ms-3">Создать магазин</span>
            </a>
        </li>
        <li class="text-left">
            <a href="#"
               class="cursor-default opacity-25 transition-all duration-150 flex items-center p-2 px-1 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group {% if request.active_page == 'integrations' %}dark:bg-gray-700{% endif %}">
                <span class="ms-3">Интеграции</span>
            </a>
        </li>
        <li class="text-left">
            <a href="{% url 'store_items' request.store.id %}"
               class="transition-all duration-150 flex items-center p-2 px-1 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group {% if request.active_page == 'items' %}dark:bg-gray-700{% endif %}">
                <span class="ms-3">Товары и услуги</span>
            </a>
        </li>
        <li class="text-left">
            <a href="{% url 'store_settings' request.store.id %}"
               class="transition-all duration-150 flex items-center p-2 px-1 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group {% if request.active_page == 'settings' %}dark:bg-gray-700{% endif %}">
                <span class="ms-3">Настройки магазина</span>
            </a>
        </li>
        <li class="text-left">
            <a href="{% url 'store_params' request.store.id %}"
               class="transition-all duration-150 flex items-center p-2 px-1 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group {% if request.active_page == 'params' %}dark:bg-gray-700{% endif %}">
                <span class="ms-3">Настройки склада</span>
            </a>
        </li>
    </ul>
</div>

<div class="content">
    <div class="block xl:flex bg-gray-800 p-4 rounded-lg gap-16 justify-end dark:border dark:border-gray-700">
        <div class="min-w-36 w-full">
            <input type="text" name="search" id="search"
                   class="bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                   placeholder="Поиск" required="">
        </div>

        <div class="block md:flex gap-8 justify-between mt-4 xl:mt-0 text-nowrap">
            <div class="flex gap-4 mb-2 md:mb-0 items-center justify-between">
                <div class="text-left xl:text-right">
                    <div>{{ request.store.name }}</div>
                    <div class="text-xs">
                        <a class="cursor-pointer text-gray-400 js-modal" data-modal="#modal_1">
                           Сменить магазин
                        </a>
                    </div>
                </div>
            </div>

            <div class="flex gap-4 items-center justify-between">
                <div>
                    <b>{{ user.username }}</b> ({{ user.email }})
                    <div class="text-xs">
                        <span>Текущая страница: {{ request.active_page }}</span>
                    </div>
                </div>

                <form method="post" action="{% url 'logout' %}">
                    {% csrf_token %}
                    <button class="btn btn-square btn-transparent-regular" type="submit">
                        <svg width="24px" height="24px" viewBox="0 0 24 24" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path fill="#EEF0F4"
                                  d="M22 6.62219V17.245C22 18.3579 21.2857 19.4708 20.1633 19.8754L15.0612 21.7977C14.7551 21.8988 14.449 22 14.0408 22C13.5306 22 12.9184 21.7977 12.4082 21.4942C12.2041 21.2918 11.898 21.0895 11.7959 20.8871H7.91837C6.38776 20.8871 5.06122 19.6731 5.06122 18.0544V17.0427C5.06122 16.638 5.36735 16.2333 5.87755 16.2333C6.38776 16.2333 6.69388 16.5368 6.69388 17.0427V18.0544C6.69388 18.7626 7.30612 19.2684 7.91837 19.2684H11.2857V4.69997H7.91837C7.20408 4.69997 6.69388 5.20582 6.69388 5.91401V6.9257C6.69388 7.33038 6.38776 7.73506 5.87755 7.73506C5.36735 7.73506 5.06122 7.33038 5.06122 6.9257V5.91401C5.06122 4.39646 6.28572 3.08125 7.91837 3.08125H11.7959C12 2.87891 12.2041 2.67657 12.4082 2.47423C13.2245 1.96838 14.1429 1.86721 15.0612 2.17072L20.1633 4.09295C21.1837 4.39646 22 5.50933 22 6.62219Z"
                                  fill="#030D45"></path>
                            <path fill="#EEF0F4"
                                  d="M4.85714 14.8169C4.65306 14.8169 4.44898 14.7158 4.34694 14.6146L2.30612 12.5912C2.20408 12.49 2.20408 12.3889 2.10204 12.3889C2.10204 12.2877 2 12.1865 2 12.0854C2 11.9842 2 11.883 2.10204 11.7819C2.10204 11.6807 2.20408 11.5795 2.30612 11.5795L4.34694 9.55612C4.65306 9.25261 5.16327 9.25261 5.46939 9.55612C5.77551 9.85963 5.77551 10.3655 5.46939 10.669L4.7551 11.3772H8.93878C9.34694 11.3772 9.7551 11.6807 9.7551 12.1865C9.7551 12.6924 9.34694 12.7936 8.93878 12.7936H4.65306L5.36735 13.5017C5.67347 13.8052 5.67347 14.3111 5.36735 14.6146C5.26531 14.7158 5.06122 14.8169 4.85714 14.8169Z"
                                  fill="#030D45"></path>
                        </svg>
                    </button>
                </form>
            </div>

        </div>
    </div>
    <div class="page-content">
        {% block content %}
        {% endblock %}
    </div>
</div>

<div class="modal-window__backdrop hidden" id="modal-backdrop"></div>

<div id="modal_1" class="modal-window window">
    <div class="window-header">
        <h3>Мои магазины</h3>
        <a href="#" class="button button-square modal-close">x</a>
    </div>
    {% include "partials/stores-list.html" %}
</div>
</body>


</html>
<script>
    function showSnackbar(elemId) {
        let x = document.getElementById(elemId);
        x.className = "snackbar-visible";
        setTimeout(function () {
            x.className = x.className.replace("snackbar-visible", "snackbar");
        }, 2000);
    }


    (function () {
        "use strict";

        let backdrop = document.getElementById('modal-backdrop');
        console.log(backdrop);
        document.addEventListener('click', modalHandler);

        function modalHandler(evt) {
            const modalBtnOpen = evt.target.closest('.js-modal');
            if (modalBtnOpen) {
                const modalSelector = modalBtnOpen.dataset.modal;
                showModal(document.querySelector(modalSelector));
            }

            const modalBtnClose = evt.target.closest('.modal-close');
            if (modalBtnClose) {
                evt.preventDefault();
                hideModal(modalBtnClose.closest('.modal-window'));
            }

            if (evt.target.matches('#modal-backdrop')) {
                hideModal(document.querySelector('.modal-window.show'));
            }
        }

        function showModal(modalElem) {
            modalElem.classList.add('show');
            backdrop.classList.remove('hidden');
        }

        function hideModal(modalElem) {
            modalElem.classList.remove('show');
            backdrop.classList.add('hidden');
        }
    })();
</script>
<script>
    document.body.addEventListener('htmx:configRequest', (event) => {
        event.detail.headers["X-CSRFToken"] = '{{csrf_token}}';
    })
</script>

<style>
    body {
        background-color: #161B21;
        color: #EEF0F4;
        min-width: 100vw;
        min-height: 100vh;
        max-width: 100vw;
        max-height: 100vh;
        display: flex;
        padding: 20px;
        box-sizing: border-box;
    }

    .sidebar {
        min-width: 248px;
        height: calc(100vh - 20px * 2);
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-right: 20px;
    }

    .sidebar-header {
        width: 100%;
        height: 80px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .content {
        width: 100%;
    }
</style>